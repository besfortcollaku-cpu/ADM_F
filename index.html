<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Adventure Maze – Admin</title>

  <style>
    body { margin:0; font-family: Arial, sans-serif; background:#0b1220; color:#e6eefc; }
    .app { display:flex; min-height:100vh; }
    .sidebar { width:240px; background:#0f1a33; padding:16px; box-sizing:border-box; border-right:1px solid #1f2a44; }
    .brand { font-weight:800; letter-spacing:.5px; margin-bottom:14px; }
    .btn { width:100%; padding:10px 12px; margin:6px 0; border:1px solid #223056; background:#101c36; color:#e6eefc; border-radius:10px; cursor:pointer; text-align:left; }
    .btn.active { background:#17305f; border-color:#2a57b8; }
    .main { flex:1; padding:18px; box-sizing:border-box; }
    pre { white-space:pre-wrap; word-break:break-word; background:#0b1220; border:1px solid #223056; padding:12px; border-radius:10px; }
    .muted { color:#9bb0d0; font-size:12px; }
  </style>
</head>

<body>
<div class="app">

  <!-- SIDEBAR -->
  <div class="sidebar">
    <div class="brand">
      Adventure Maze<br/>
      <span class="muted">Admin Panel</span>
    </div>

    <button class="btn active" id="nav-dashboard">Dashboard</button>
  </div>

  <!-- MAIN -->
  <div class="main">
    <h2>Dashboard</h2>
    <div id="dashboard">Loading…</div>
  </div>

</div>

<!-- =========================
     ADMIN SCRIPT
========================= -->
<script>
const API_BASE = "https://adventuremaze.onrender.com";
let ADMIN_SECRET = sessionStorage.getItem("ADMIN_SECRET");

function requireSecret() {
  if (!ADMIN_SECRET) {
    ADMIN_SECRET = prompt("Enter admin secret:");
    if (!ADMIN_SECRET) {
      alert("Admin secret required");
      throw new Error("No admin secret");
    }
    sessionStorage.setItem("ADMIN_SECRET", ADMIN_SECRET);
  }
}

async function adminFetch(path) {
  requireSecret();
  const res = await fetch(API_BASE + path, {
    headers: {
      "x-admin-secret": ADMIN_SECRET
    }
  });

  if (!res.ok) {
    throw new Error("Admin request failed: " + res.status);
  }
  return res.json();
}

async function loadDashboard() {
  try {
    const data = await adminFetch("/admin/stats");
    console.log("ADMIN STATS:", data);

    document.getElementById("dashboard").innerHTML =
      "<pre>" + JSON.stringify(data, null, 2) + "</pre>";

  } catch (e) {
    console.error(e);
    document.getElementById("dashboard").innerHTML =
      "<span style='color:#ffb4b4'>Error: " + e.message + "</span>";
  }
}

document.getElementById("nav-dashboard").onclick = () => {
  document.querySelectorAll(".btn").forEach(b => b.classList.remove("active"));
  document.getElementById("nav-dashboard").classList.add("active");
  loadDashboard();
};

window.onload = loadDashboard;
</script>

</body>
</html>